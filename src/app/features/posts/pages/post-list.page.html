<h1 class="text-2xl font-bold mb-4">Posts</h1>

<!-- Busca -->
<input
  type="text"
  placeholder="Buscar por título ou corpo..."
  [(ngModel)]="searchTerm"
  (ngModelChange)="onSearchChange($event)"
  class="border px-3 py-2 rounded w-full mb-4"
/>

<!-- Tabela de posts -->
<table class="w-full table-auto border-collapse">
  <thead>
    <tr class="bg-gray-100 text-left">
      <th class="p-2 cursor-pointer" (click)="toggleSort('id')">ID</th>
      <th class="p-2 cursor-pointer" (click)="toggleSort('title')">Título</th>
      <th class="p-2 cursor-pointer" (click)="toggleSort('body')">Corpo</th>
      <th class="p-2">Ações</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let post of paginatedPosts" class="border-b hover:bg-gray-50">
      <td class="p-2">{{ post.id }}</td>
      <td class="p-2">{{ post.title }}</td>
      <td class="p-2">{{ post.body }}</td>
      <td class="p-2 flex gap-4">
  <!-- Detalhes -->
  <a [routerLink]="['/posts', post.id]" class="text-blue-600 hover:text-blue-800" title="Ver detalhes">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
      d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
  </svg>
</a>


  <!-- Editar -->
  <button (click)="startEdit(post)" class="text-green-600 hover:text-green-800" title="Editar">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5M18.5 2.5a2.121 2.121 0 113 3L12 15l-4 1 1-4 9.5-9.5z" />
    </svg>
  </button>

  <!-- Excluir -->
  <button (click)="startDelete(post)" class="text-red-600 hover:text-red-800" title="Excluir">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M6 18L18 6M6 6l12 12" />
    </svg>
  </button>
</td>

    </tr>
  </tbody>
</table>

<!-- Paginação -->
<div class="flex justify-center items-center gap-2 mt-4">
  <button
    *ngFor="let page of [].constructor(totalPages); let i = index"
    (click)="goToPage(i + 1)"
    [class.bg-blue-600]="currentPage === i + 1"
    [class.text-white]="currentPage === i + 1"
    class="px-3 py-1 border rounded hover:bg-blue-100"
  >
    {{ i + 1 }}
  </button>
</div>

<!-- Modal de criação/edição -->
<app-modal [title]="editingPost ? 'Editar Post' : 'Novo Post'" *ngIf="showModal || editingPost" (close)="showModal = false; editingPost = null">
  <app-post-form
    [post]="editingPost || { title: '', body: '' }"
    (submitPost)="editingPost ? handleEditSubmit($event) : handleModalSubmit($event)"
    (cancel)="showModal = false; editingPost = null"
/>
</app-modal>

<!-- Modal de confirmação de exclusão -->
<app-modal [title]="'Confirmar exclusão'" *ngIf="pendingDelete" (close)="pendingDelete = null">
  <p class="mb-4">Tem certeza que deseja excluir o post <strong>#{{ pendingDelete.id }}</strong>?</p>

  <div class="flex justify-end gap-2">
    <button (click)="pendingDelete = null" class="px-4 py-2 bg-gray-300 rounded">Cancelar</button>
    <button (click)="confirmDelete()" class="px-4 py-2 bg-red-600 text-white rounded">Excluir</button>
  </div>
</app-modal>