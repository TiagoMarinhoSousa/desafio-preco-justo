<div class="flex items-center justify-between mb-6 bg-gray-100 p-4 rounded"> 
  <h1 class="text-2xl font-bold">Comentários do Post #{{ postId }}</h1> 
  <div class="flex items-center gap-2">
    <button (click)="onAddComment()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
      Adicionar Comentário
    </button>   
    <a [routerLink]="['/posts']" class="bg-gray-300 text-black p-2 rounded hover:bg-gray-400" title="Voltar para Posts">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M15 19l-7-7 7-7" />
      </svg>
    </a>
  </div>
</div>

<ng-container *ngIf="comments$ | async as comments">
  <app-comment-list
    [comments]="comments"
    (edit)="onEditComment($event)"
    (delete)="onDeleteComment($event)"
  />
</ng-container>

<app-modal [title]="'Comentário'" *ngIf="commentModalVisible" (close)="resetModals()">
  <label class="block mb-2">Nome</label>
  <input [(ngModel)]="editingComment!.name" class="w-full border px-2 py-1 mb-4" />

  <label class="block mb-2">Email</label>
  <input [(ngModel)]="editingComment!.email" class="w-full border px-2 py-1 mb-4" />

  <label class="block mb-2">Mensagem</label>
  <textarea [(ngModel)]="editingComment!.body" class="w-full border px-2 py-1 mb-4"></textarea>

  <div class="flex justify-end gap-2">
    <button (click)="resetModals()" class="px-4 py-2 bg-gray-300 rounded">Cancelar</button>
    <button (click)="onSubmitComment(editingComment!)" class="px-4 py-2 bg-green-600 text-white rounded">Salvar</button>
  </div>
</app-modal>

<app-modal [title]="'Confirmar exclusão'" *ngIf="confirmModalVisible" (close)="resetModals()">
  <p class="mb-4">Tem certeza que deseja excluir este comentário?</p>

  <div class="flex justify-end gap-2">
    <button (click)="resetModals()" class="px-4 py-2 bg-gray-300 rounded">Cancelar</button>
    <button (click)="onConfirmDelete()" class="px-4 py-2 bg-red-600 text-white rounded">Excluir</button>
  </div>
</app-modal>

<div *ngIf="isLoading" class="flex justify-center items-center py-10">
  <svg class="animate-spin h-6 w-6 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
    <path class="opacity-75" fill="currentColor"
      d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z">
    </path>
  </svg>
  <span class="ml-2 text-gray-600">Carregando comentários...</span>
</div>

<div *ngIf="errorMessage && !isLoading" class="text-center text-red-600 py-4">
  {{ errorMessage }}
</div>

